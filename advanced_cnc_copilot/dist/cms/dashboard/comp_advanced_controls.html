<div class="card shadow mb-4" id="advanced-tuning-panel">
    <div class="card-header py-3 bg-gradient-dark text-white d-flex align-items-center justify-content-between"
        style="border-bottom: 2px solid var(--primary);">
        <h6 class="m-0 font-weight-bold"><i class="fas fa-microchip"></i> Power User Tuning Hub</h6>
        <span class="badge badge-danger">DANGER: RAW OVERRIDE</span>
    </div>
    <div class="card-body bg-dark text-light">
        <div class="row">
            <!-- PID Tuning Stubs -->
            <div class="col-md-6 border-right">
                <p class="small font-weight-bold text-uppercase" style="color:var(--primary);">Control Loop Offsets
                    (PID)</p>
                <div class="form-group row no-gutters mb-2">
                    <label class="col-4 text-xs">P-Gain:</label>
                    <input type="number"
                        class="col-8 form-control form-control-sm bg-black text-success border-secondary" value="12.5"
                        step="0.1">
                </div>
                <div class="form-group row no-gutters mb-2">
                    <label class="col-4 text-xs">I-Gain:</label>
                    <input type="number"
                        class="col-8 form-control form-control-sm bg-black text-success border-secondary" value="0.04"
                        step="0.01">
                </div>
                <div class="form-group row no-gutters">
                    <label class="col-4 text-xs">D-Gain:</label>
                    <input type="number"
                        class="col-8 form-control form-control-sm bg-black text-success border-secondary" value="1.2"
                        step="0.1">
                </div>
            </div>

            <!-- Optimization Weights -->
            <div class="col-md-6">
                <p class="small font-weight-bold text-uppercase" style="color:var(--warning);">Optimization Weights
                    (Manual)</p>
                <div class="form-group mb-2">
                    <label class="text-xs d-flex justify-content-between">Safety Threshold: <span
                            id="weight-safe">80%</span></label>
                    <input type="range" class="custom-range" value="80"
                        oninput="document.getElementById('weight-safe').innerText=this.value+'%'">
                </div>
                <div class="form-group mb-2">
                    <label class="text-xs d-flex justify-content-between">Performance Bias: <span
                            id="weight-perf">20%</span></label>
                    <input type="range" class="custom-range" value="20"
                        oninput="document.getElementById('weight-perf').innerText=this.value+'%'">
                </div>
            </div>
        </div>

        <div class="mt-3 p-2 bg-black border border-secondary rounded">
            <p class="small font-weight-bold text-uppercase mb-1" style="color:var(--primary);">Raw Cortex Inspector</p>
            <div id="raw-json-viewer"
                style="font-family:'Courier New', monospace; font-size:10px; height:80px; overflow-y:auto; color:#0f0;">
                { "active_threads": 42, "memory_pressure": "low", "io_wait": 0.12, "last_synapse":
                "2026-01-24T20:15:39Z" }
            </div>
        </div>

        <!-- SEQUENCE CHI: DOCUMENT PROVENANCE -->
        <div class="mt-3 p-2 bg-black border border-warning rounded">
            <p class="small font-weight-bold text-uppercase mb-1" style="color:var(--warning);">Provenance Audit (Origin
                Trace)</p>
            <div class="input-group input-group-sm mb-2">
                <input type="text" id="origin-job-id" class="form-control bg-dark text-white border-secondary"
                    placeholder="Enter Job ID (e.g., JOB-SEM-...)">
                <div class="input-group-append">
                    <button class="btn btn-warning" type="button" onclick="fetchProvenance()">FETCH ORIGIN</button>
                </div>
            </div>
            <div id="provenance-result" class="text-xs"
                style="color:rgba(255,255,255,0.5); max-height:100px; overflow-y:auto; font-family:monospace;">
                Ready for audit...
            </div>
        </div>

        <div class="mt-3 text-right">
            <button class="btn btn-outline-danger btn-sm" onclick="forceSystemSeal()">FORCE COMMAND SEAL</button>
            <button class="btn btn-primary btn-sm" onclick="applyAdvancedTuning()">APPLY FIRMWARE OVERRIDE</button>
        </div>
    </div>
</div>

<style>
    .bg-black {
        background-color: #000;
    }
</style>

<script>
    function fetchProvenance() {
        const jobId = document.getElementById('origin-job-id').value;
        if (!jobId) return;

        const resultDiv = document.getElementById('provenance-result');
        resultDiv.innerHTML = "Fetching lineage from Cortex...";

        fetch(`/api/provenance/${jobId}`)
            .then(r => r.json())
            .then(data => {
                if (data.status === 'SUCCESS') {
                    const p = data.provenance;
                    resultDiv.innerHTML = `
                        <span class="text-success">[VALIDATED]</span> UID: ${p.timestamp}<br>
                        <span class="text-info">INTENT:</span> ${JSON.stringify(p.intent).substring(0, 50)}...<br>
                        <span class="text-warning">EVO_ID:</span> ${p.evolution_id}
                    `;
                } else {
                    resultDiv.innerHTML = `<span class="text-danger">ERROR:</span> ${data.message}`;
                }
            });
    }

    function applyAdvancedTuning() {
        if (confirm("DANGER: This directly modifies the EvolutionRuntime safety layers. Proceed?")) {
            addLogLine("SYS", "FIRMWARE_OVERRIDE_APPLIED: BYPASS_G90_CHECK=FALSE");
        }
    }

    function forceSystemSeal() {
        addLogLine("SYS", "COMMAND_SEAL_ENGAGED: SYSTEM_LOCKED_FOR_MAINTENANCE");
    }
</script>